<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Manifold Market Predictor</title>

  <!-- Font Awesome for icons -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }

    header, main, footer {
      max-width: 1200px;
      margin: auto;
      padding: 1rem 1.5rem;
    }

    header {
      border-bottom: 2px solid #ddd;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 0.3rem;
    }

    .tagline {
      font-size: 0.95rem;
      color: #666;
    }

    input[type="text"] {
      padding: 0.5rem;
      margin: 1rem 0;
      width: 100%;
      max-width: 400px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .cards-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .card {
      background: #fff;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      transition: opacity 0.3s;
    }

    .card.filtered-out {
      opacity: 0;
      pointer-events: none;
    }

    #loadMoreBtn {
      margin: 1.5rem 0;
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    #loadMoreBtn:hover {
      background-color: #0056b3;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.95rem;
      margin-top: 1rem;
    }

    thead th {
      background: #f0f0f0;
      padding: 0.5rem;
      text-align: left;
      border-bottom: 2px solid #ccc;
      position: sticky;
      top: 0;
    }

    tbody td {
      padding: 0.5rem;
      border-bottom: 1px solid #eee;
    }

    .highlight {
      background-color: yellow;
    }

    .table-container {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    footer {
      text-align: center;
      padding: 2rem 1rem;
      background: #f1f1f1;
      font-size: 0.9rem;
      color: #555;
    }

    .contacts {
      list-style: none;
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      padding: 0;
      margin-top: 0.5rem;
    }

    .contacts li {
      display: flex;
      align-items: center;
    }

    .contacts i {
      margin-right: 0.5rem;
    }

    @media (max-width: 600px) {
      .contacts {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Manifold Market Predictor</h1>
    <p class="tagline">An unofficial project by <strong>DMCHER.store</strong> – Created by Dinmukhammed Toleubay</p>
  </header>

  <main>
    <section id="predictions">
      <h2>Top Predictions</h2>
      <input type="text" id="cardSearch" placeholder="Search predictions..." oninput="filterCards()" />
      <div class="cards-container" id="cardsContainer"></div>
      <button id="loadMoreBtn" onclick="loadMore()">Load More</button>
    </section>

    <section id="backtest">
      <h2>Backtested Results</h2>
      <div id="accuracySummary"><strong>Model Accuracy:</strong> ...</div>
      <input type="text" id="backtestSearch" placeholder="Search past questions..." oninput="filterBacktest()" />
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Question</th>
              <th>Predicted %</th>
              <th>Predicted</th>
              <th>Actual</th>
              <th>Result</th>
            </tr>
          </thead>
          <tbody id="backtestTable"></tbody>
        </table>
      </div>
    </section>

    <section id="about">
      <h2>About this Project</h2>
      <p>
        The Manifold Market Predictor is an unofficial, educational tool that uses real-time data from Manifold Markets to forecast outcomes of unresolved binary (YES/NO) questions. It combines GPT analysis of market text with a Random Forest model trained on resolved markets to estimate the probability of a "YES" outcome.
      </p>
      <p>
        Disclaimer: This project is not affiliated with Manifold Markets. Predictions are speculative and for educational use only.
      </p>
    </section>
  </main>

  <footer>
    <p>Connect with the creator:</p>
    <ul class="contacts">
      <li><i class="fab fa-instagram"></i><a href="https://www.instagram.com/dinmukhammed.toleubay/" target="_blank">Instagram</a></li>
      <li><i class="fab fa-github"></i><a href="https://github.com/DMCHERy/dmchery.github.io" target="_blank">GitHub</a></li>
      <li><i class="fas fa-envelope"></i><a href="mailto:dinmukhammed.toleubay@gmail.com">Email</a></li>
    </ul>
  </footer>

  <script>
    let allPredictions = [];
    let cardsShown = 0;

    async function fetchPredictions() {
      const response = await fetch('predictions.json');
      allPredictions = await response.json();
      displayNextBatch(7);
      populateBacktestTable();
    }

    function displayNextBatch(count) {
      const container = document.getElementById('cardsContainer');
      const next = allPredictions.slice(cardsShown, cardsShown + count);
      next.forEach(pred => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3 class="question">${pred.question}</h3>
          <p>Predicted chance: <strong>${(pred.probability * 100).toFixed(1)}%</strong></p>
        `;
        container.appendChild(card);
      });
      cardsShown += next.length;
      if (cardsShown >= allPredictions.length) {
        document.getElementById('loadMoreBtn').style.display = 'none';
      }
    }

    function loadMore() {
      displayNextBatch(10);
    }

    function filterCards() {
      const query = document.getElementById('cardSearch').value.toLowerCase();
      document.querySelectorAll('.card').forEach(card => {
        const text = card.querySelector('.question').textContent.toLowerCase();
        card.classList.toggle('filtered-out', !text.includes(query));
      });
    }

    function populateBacktestTable() {
      const tbody = document.getElementById('backtestTable');
      const summary = document.getElementById('accuracySummary');
      let correct = 0;

      tbody.innerHTML = '';
      allPredictions.forEach(pred => {
        const predicted = pred.probability > 0.5 ? 'YES' : 'NO';
        const actual = pred.actualOutcome;
        const isCorrect = predicted === actual;
        if (isCorrect) correct++;

        const row = document.createElement('tr');
        row.dataset.question = pred.question;

        row.innerHTML = `
          <td class="qCell">${pred.question}</td>
          <td>${(pred.probability * 100).toFixed(1)}%</td>
          <td>${predicted}</td>
          <td>${actual}</td>
          <td>${isCorrect ? '✔️' : '❌'}</td>
        `;
        tbody.appendChild(row);
      });

      const percent = (correct / allPredictions.length * 100).toFixed(1);
      summary.innerHTML = `<strong>Model Accuracy:</strong> ${percent}% correct`;
    }

    function highlightMatches(text, term) {
      const safeTerm = term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      const regex = new RegExp(safeTerm, 'gi');
      return text.replace(regex, match => `<span class="highlight">${match}</span>`);
    }

    function filterBacktest() {
      const query = document.getElementById('backtestSearch').value.toLowerCase();
      const rows = document.querySelectorAll('#backtestTable tr');

      rows.forEach(row => {
        const original = row.dataset.question;
        const text = original.toLowerCase();
        const match = text.includes(query);
        row.style.display = match ? '' : 'none';
        if (match) {
          const highlighted = highlightMatches(original, query);
          row.querySelector('.qCell').innerHTML = highlighted;
        }
      });
    }

    fetchPredictions();
  </script>
</body>
</html>
