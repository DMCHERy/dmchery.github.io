<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Manifold Predictor Showcase</title>
  <style>
    body {
      background-color: #0f1115;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #0d1117;
      padding: 1.5rem;
      text-align: center;
      border-bottom: 2px solid #61dafb;
    }

    header h1 {
      margin: 0;
      font-size: 2rem;
      color: #61dafb;
    }

    .container {
      max-width: 1200px;
      margin: auto;
      padding: 2rem;
    }

    .search-input {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 1.5rem;
      font-size: 1rem;
      border: none;
      border-radius: 5px;
    }

    #predictions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .card {
      background: #1c1f26;
      border: 1px solid #333;
      border-radius: 10px;
      padding: 1rem;
      box-shadow: 0 2px 5px rgba(97, 218, 251, 0.2);
      transition: transform 0.3s;
    }

    .card:hover {
      transform: scale(1.01);
    }

    .yes { color: #4ade80; }
    .no { color: #f87171; }

    .button, #loadMore, #loadMoreBacktest, #toggleBacktest {
      background-color: #61dafb;
      color: #000;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 1rem;
    }

    .hidden { display: none; }

    .about-section {
      background: #1a1e24;
      padding: 2rem;
      border-radius: 10px;
      margin-top: 3rem;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    th, td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #444;
    }

    .highlight {
      background-color: yellow;
      color: black;
    }
  </style>
</head>
<body>
  <header>
    <h1>Manifold Market Predictor</h1>
    <p>Powered by GPT + Random Forest</p>
  </header>

  <div class="container">
    <input type="text" id="searchInput" class="search-input" placeholder="Search predictions...">
    <div id="predictions"></div>
    <button id="loadMore">Load More</button>

    <button id="toggleBacktest">Toggle Backtest Data</button>

    <div id="backtestSection" class="hidden">
      <input type="text" id="backtestSearch" class="search-input" placeholder="Search backtest questions...">
      <div id="accuracySummary"></div>
      <table id="backtestTable">
        <thead>
          <tr>
            <th>Question</th>
            <th>Predicted %</th>
            <th>Predicted</th>
            <th>Actual</th>
            <th>Correct?</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <button id="loadMoreBacktest">Load More Backtest Rows</button>
    </div>

        <div class="about-section">
      <h2>About this Project</h2>
      <p>
        <strong>Disclaimer:</strong> This project is not affiliated with Manifold Markets.
        It was made, built, and showcased by Dinmukhammed Toleubay —
        GitHub user <a href="https://github.com/DMCHERy" target="_blank">DMCHERy</a>,
        where you'll also find the full project files and instructions to try it yourself.
        This tool is for research and educational purposes only.
      </p>
      <p>
        The Manifold Market Predictor is an <strong>unofficial, educational tool</strong>
        that uses real-time data from Manifold Markets to forecast outcomes of unresolved binary questions.
        It combines <strong>GPT-3.5</strong> (for analyzing the market question)
        and a <strong>Random Forest</strong> machine learning model
        (trained on past resolved markets) to estimate the probability of a "YES" resolution for each market.
        The model outputs a ranked list of predictions, as shown above, without needing to wait for actual resolutions.
      </p>
      <p><strong>Disclaimer:</strong> This is not financial advice. Use it for fun and curiosity only.</p>
      <p>
        Instagram: <a href="https://www.instagram.com/dinmukhammed.toleubay/" target="_blank">dinmukhammed.toleubay</a><br>
        GitHub: <a href="https://github.com/DMCHERy/dmchery.github.io" target="_blank">DMCHERy</a><br>
        Email: <a href="mailto:dinmukhammed.toleubay@gmail.com">dinmukhammed.toleubay@gmail.com</a>
      </p>
    </div> <!-- END about-section -->
  </div> <!-- END container -->


  <script>
    let predictions = [];
    let backtestIndex = 0;
    let visibleIndex = 0;
    const batchSize = 7;

    async function loadData() {
      const res = await fetch("predictions.json");
      predictions = await res.json();
      predictions.reverse();
      showNextBatch();
      showNextBacktestBatch();
    }

    function showNextBatch() {
      const container = document.getElementById("predictions");
      const slice = predictions.slice(visibleIndex, visibleIndex + batchSize);
      slice.forEach(pred => {
        const card = document.createElement("div");
        card.className = "card";
        const isYes = pred.probability >= 0.5;
        card.innerHTML = `
          <div class="question">${pred.question}</div>
          <div class="probability ${isYes ? 'yes' : 'no'}">Predicted ${isYes ? 'YES' : 'NO'}: <strong>${(pred.probability * 100).toFixed(1)}%</strong></div>
          <div class="date">Date: ${pred.date}</div>
          <a href="${pred.link}" target="_blank"><button class="button">View Market</button></a>
        `;
        container.appendChild(card);
      });
      visibleIndex += batchSize;
      if (visibleIndex >= predictions.length) document.getElementById("loadMore").classList.add("hidden");
    }

    function showNextBacktestBatch() {
      const tbody = document.querySelector("#backtestTable tbody");
      let correct = 0;
      let total = 0;

      for (let i = backtestIndex; i < backtestIndex + batchSize && i < predictions.length; i++) {
        const pred = predictions[i];
        if (!("actualOutcome" in pred)) continue;

        const predicted = pred.probability >= 0.5 ? "YES" : "NO";
        const actual = pred.actualOutcome || "?";
        const isCorrect = actual !== "?" && predicted === actual;
        if (actual !== "?") total++;
        if (isCorrect) correct++;

        const row = document.createElement("tr");
        row.dataset.question = pred.question.toLowerCase();
        row.innerHTML = `
          <td class="qCell">${pred.question}</td>
          <td>${(pred.probability * 100).toFixed(1)}%</td>
          <td>${predicted}</td>
          <td>${actual}</td>
          <td>${actual === "?" ? "?" : (isCorrect ? "✔️" : "❌")}</td>
        `;
        tbody.appendChild(row);
      }

      if (total > 0) {
        const accuracy = (correct / total * 100).toFixed(1);
        document.getElementById("accuracySummary").textContent = `Accuracy: ${accuracy}%`;
      }

      backtestIndex += batchSize;
      if (backtestIndex >= predictions.length) document.getElementById("loadMoreBacktest").classList.add("hidden");
    }

    // Search Filters
    document.getElementById("searchInput").addEventListener("input", e => {
      const q = e.target.value.toLowerCase();
      document.querySelectorAll("#predictions .card").forEach(card => {
        card.style.display = card.querySelector(".question").textContent.toLowerCase().includes(q) ? "block" : "none";
      });
    });

    document.getElementById("backtestSearch").addEventListener("input", e => {
      const q = e.target.value.toLowerCase();
      document.querySelectorAll("#backtestTable tbody tr").forEach(row => {
        const text = row.dataset.question;
        row.style.display = text.includes(q) ? "" : "none";
        row.querySelector(".qCell").innerHTML = highlightMatch(text, q);
      });
    });

    function highlightMatch(text, q) {
      if (!q) return text;
      return text.replace(new RegExp(q, 'gi'), match => `<span class="highlight">${match}</span>`);
    }

    document.getElementById("loadMore").onclick = showNextBatch;
    document.getElementById("loadMoreBacktest").onclick = showNextBacktestBatch;
    document.getElementById("toggleBacktest").onclick = () => {
      document.getElementById("backtestSection").classList.toggle("hidden");
    };

    loadData();
  </script>
</body>
</html>
